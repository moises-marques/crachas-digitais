<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Crachás e Cartões</title>
  <style>
    body { font-family: system-ui, sans-serif; margin: 24px; display: flex; flex-direction: column; align-items: center; }
    .search-container { margin-bottom: 20px; }
    #searchInput { padding: 10px; font-size: 16px; border-radius: 5px; border: 1px solid #ccc; width: 300px; }
    #searchBtn { padding: 10px 15px; font-size: 16px; border-radius: 5px; border: none; background-color: #007BFF; color: white; cursor: pointer; }
    .card { width: 300px; padding: 20px; border: 1px solid #ccc; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); text-align: center; margin-top: 20px; }
    .card img { width: 150px; height: 150px; object-fit: cover; border-radius: 50%; margin-bottom: 15px; }
    .card h3 { margin: 0; font-size: 1.5em; }
    .card p { margin: 5px 0; font-size: 1em; color: #555; }
    .card .email { font-size: 0.9em; color: #888; }
  </style>
</head>
<body>
  <div class="search-container">
    <input type="text" id="searchInput" placeholder="Digite seu nome ou ID" />
    <button id="searchBtn">Buscar</button>
  </div>
  <div id="lista">
    <p>Utilize a busca para encontrar seu crachá.</p>
  </div>
  <script>
    const API_URL = 'https://script.google.com/macros/s/AKfycbz7iR5j_BHsi3aSvPh-JhpdbRWTy8sPf4jtxzJULSg6UvKdHiHc04ljIkLXIh3inL_H/exec';

    document.getElementById('searchBtn').addEventListener('click', buscarCracha);
    document.getElementById('searchInput').addEventListener('keypress', function(event) {
      if (event.key === 'Enter') {
        buscarCracha();
      }
    });

    function buscarCracha() {
      const termoBusca = document.getElementById('searchInput').value.toLowerCase();
      const el = document.getElementById('lista');
      el.innerHTML = '<p>Buscando...</p>';

      fetch(API_URL)
        .then(r => r.json())
        .then(data => {
          const encontrado = data.find(x => 
            (x.Ativo || '').toLowerCase() === 'sim' &&
            ((x.Nome || '').toLowerCase().includes(termoBusca) || (x.ID || '').toString() === termoBusca)
          );

          el.innerHTML = '';
          if (encontrado) {
            el.innerHTML = `
              <div class="card">
                ${encontrado.FotoURL ? `<img src="${encontrado.FotoURL}" alt="${encontrado.Nome}"/>` : ''}
                <h3>${encontrado.Nome || ''}</h3>
                <p>${encontrado.Cargo || ''}</p>
                <p>${encontrado.Empresa || ''}</p>
                <p>${encontrado.Setor || ''}</p>
                <p class="email">${encontrado.Email || ''}</p>
                <p>${encontrado.Telefone || ''}</p>
              </div>
            `;
          } else {
            el.innerHTML = '<p>Crachá não encontrado. Verifique se o nome ou ID estão corretos.</p>';
          }
        })
        .catch(err => {
          console.error('Erro ao carregar dados:', err);
          el.innerHTML = `<p>Ocorreu um erro ao carregar os dados.</p>`;
        });
    }
  </script>
</body>
</html>
